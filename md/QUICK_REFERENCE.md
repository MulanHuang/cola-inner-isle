# 🚀 OpenAI 深度解读 - 快速参考卡片

> 一页纸搞定所有配置和故障排查

---

## ⚡ 三步配置

```
1️⃣ 部署云函数
   右键 cloudfunctions/common → 上传并部署：云端安装依赖
   右键 cloudfunctions/mbti-analyze → 上传并部署：云端安装依赖

2️⃣ 配置环境变量
   云开发控制台 → 云函数 → mbti-analyze → 函数配置
   添加：OPENAI_API_KEY = 你的 API Key

3️⃣ 运行测试
   Console 中运行 quick-test.js
```

---

## 🧪 测试脚本

| 脚本                            | 用途     | 耗时   |
| ------------------------------- | -------- | ------ |
| **quick-test.js**               | 快速验证 | 1 分钟 |
| **test-mbti-cloud-function.js** | 完整测试 | 2 分钟 |
| **diagnose.js**                 | 系统诊断 | 3 分钟 |

**使用方法：** 复制脚本内容 → 粘贴到 Console → 回车执行

---

## 📚 文档导航

| 文档                        | 适用场景     |
| --------------------------- | ------------ |
| **AI_SETUP_README.md**      | 快速了解全貌 |
| **COMPLETE_SETUP_GUIDE.md** | 详细配置步骤 |
| **DEPLOYMENT_CHECKLIST.md** | 逐项检查确认 |
| **IMPROVEMENTS_SUMMARY.md** | 了解改进内容 |

---

## 🔧 常见问题速查

### ❌ 云函数调用失败

```
错误：function not found
解决：重新部署云函数
```

### ⚠️ 使用默认解读

```
原因：OPENAI_API_KEY 未配置
解决：配置环境变量，等待 1-2 分钟
```

### 🐌 响应很慢（> 5 秒）

```
原因：网络问题或 OpenAI 服务慢
解决：检查网络，多次测试确认
```

### 🔑 401 错误

```
原因：API Key 无效
解决：检查 API Key 是否正确
```

### 💰 429 错误

```
原因：超出限额或余额不足
解决：充值或等待限额重置
```

---

## 📊 性能基准

| 指标       | 优秀   | 良好   | 较慢   |
| ---------- | ------ | ------ | ------ |
| 云函数调用 | < 3 秒 | 3-5 秒 | > 5 秒 |
| 总耗时     | < 3 秒 | 3-5 秒 | > 5 秒 |

---

## 💰 成本参考

| 项目      | 费用         |
| --------- | ------------ |
| 模型      | gpt-5-mini   |
| 每次解读  | $0.001-0.002 |
| $5 可支持 | 2500-5000 次 |

---

## 🔍 日志查看

```
云开发控制台 → 云函数 → mbti-analyze → 日志
```

---

## 🎯 成功标志

- ✅ 测试脚本显示"测试通过"
- ✅ 小程序中可以获取 AI 解读
- ✅ 解读内容是个性化的
- ✅ 响应时间 < 5 秒

---

## 📞 需要帮助？

提供以下信息：

1. 测试脚本输出（截图）
2. 云函数日志（截图）
3. 错误信息（截图）

---

## 🔗 有用链接

- OpenAI API Keys: https://platform.openai.com/api-keys
- OpenAI 余额: https://platform.openai.com/account/usage
- OpenAI 状态: https://status.openai.com/
- 云开发控制台: https://console.cloud.tencent.com/tcb

---

## 💡 优化建议

### 提高速度

- 减少 maxTokens 到 1500
- 使用 gpt-3.5-turbo

### 降低成本

- 使用 gpt-3.5-turbo
- 添加缓存机制

### 提高质量

- 增加 temperature 到 0.8
- 优化提示词

---

## 🛡️ 安全检查

- [ ] API Key 未提交到代码仓库
- [ ] 环境变量配置正确
- [ ] 已设置使用限额（可选）
- [ ] 定期轮换 API Key

---

## 📋 部署检查清单

- [ ] common 模块已部署
- [ ] mbti-analyze 已部署
- [ ] 环境变量已配置
- [ ] 快速测试通过
- [ ] 系统诊断通过
- [ ] 小程序测试通过

---

## 🎓 关键命令

### 查看云函数列表

```
云开发控制台 → 云函数
```

### 查看环境变量

```
云函数 → mbti-analyze → 函数配置 → 环境变量
```

### 测试云函数

```
云函数 → mbti-analyze → 测试
```

### 查看日志

```
云函数 → mbti-analyze → 日志
```

---

## 🔄 故障排查流程

```
1. 运行 diagnose.js
   ↓
2. 查看诊断报告
   ↓
3. 根据建议修复
   ↓
4. 重新测试
   ↓
5. 查看云函数日志（如果还有问题）
```

---

## ✨ 改进亮点

### v2.0 新功能

- ✅ 详细的日志输出
- ✅ 性能指标监控
- ✅ 三个测试脚本
- ✅ 完整的文档体系
- ✅ 友好的错误提示

---

## 📱 小程序测试步骤

```
1. 进入 MBTI 测试页面
2. 完成 70 道题目
3. 查看测试结果
4. 点击"获取 AI 深度解读"
5. 等待 2-5 秒
6. 查看解读内容
```

---

## 🎉 预期效果

### 成功时

```
✅ 调用成功！耗时：2847ms
🎉 AI 解读生成成功！
⚡ 性能：优秀（< 3秒）
✅ 测试通过！功能正常运作。
```

### 使用兜底内容时

```
⚠️  使用了兜底内容
原因：OPENAI_API_KEY 未配置
建议：配置环境变量以使用 AI 解读
```

---

**版本：** v2.0  
**更新：** 2025-11-23

---

**💡 提示：** 将此文件保存为书签，随时查阅！
