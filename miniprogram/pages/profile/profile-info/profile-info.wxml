<!--pages/profile/profile-info/profile-info.wxml-->
<view class="profile-info-page">
  <!-- é¡¶éƒ¨æç¤ºæ¡ -->
  <view class="tip-banner">
    <text class="tip-icon">ğŸ””</text>
    <text class="tip-text">å®Œå–„ä¸ªäººèµ„æ–™ï¼Œè·å¾—æ›´å‡†ç¡®çš„è§£è¯»å“¦ï¼</text>
  </view>

  <!-- æ€§åˆ«é€‰æ‹© -->
  <view class="section">
    <view class="section-title">æ€§åˆ«</view>
    <view class="gender-row">
      <view
        class="gender-card {{gender === 'male' ? 'active' : ''}}"
        data-gender="male"
        bindtap="selectGender"
        hover-class="gender-card-hover"
      >
        <view class="gender-avatar-wrap {{gender === 'male' ? 'active' : ''}}">
          <view class="gender-avatar male">ğŸ§‘</view>
          <view class="gender-glow" wx:if="{{gender === 'male'}}"></view>
        </view>
        <view class="gender-label">ç”·ç”Ÿ</view>
        <view class="gender-check" wx:if="{{gender === 'male'}}">âœ“</view>
      </view>
      <view
        class="gender-card {{gender === 'female' ? 'active' : ''}}"
        data-gender="female"
        bindtap="selectGender"
        hover-class="gender-card-hover"
      >
        <view class="gender-avatar-wrap {{gender === 'female' ? 'active' : ''}}">
          <view class="gender-avatar female">ğŸ‘©</view>
          <view class="gender-glow" wx:if="{{gender === 'female'}}"></view>
        </view>
        <view class="gender-label">å¥³ç”Ÿ</view>
        <view class="gender-check" wx:if="{{gender === 'female'}}">âœ“</view>
      </view>
    </view>
  </view>

  <!-- å‡ºç”Ÿä¿¡æ¯ -->
  <view class="section">
    <view class="section-title">å‡ºç”Ÿä¿¡æ¯</view>
    <view class="form-card">
      <view class="form-item" bindtap="openDateTimePicker">
        <view class="label">å‡ºç”Ÿæ—¥æœŸ</view>
        <view class="picker-value {{birthDate ? '' : 'placeholder'}}">
          {{birthDate || 'è¯·é€‰æ‹©'}}
          <text class="arrow">â€º</text>
        </view>
      </view>
      <view class="form-item" bindtap="openDateTimePicker">
        <view class="label">å‡ºç”Ÿæ—¶é—´</view>
        <view class="picker-value {{birthTime ? '' : 'placeholder'}}">
          {{birthTime || 'è¯·é€‰æ‹©'}}
          <text class="arrow">â€º</text>
        </view>
      </view>
      <view class="form-item" bindtap="openRegionPicker" data-type="birth">
        <view class="label">å‡ºç”Ÿåœ°ç‚¹</view>
        <view class="picker-value {{birthPlace ? '' : 'placeholder'}}">
          {{birthPlace || 'è¯·é€‰æ‹©'}}
          <text class="arrow">â€º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç°å±…åœ° -->
  <view class="section">
    <view class="section-title">ç°å±…åœ°</view>
    <view class="form-card">
      <view class="form-item" bindtap="openRegionPicker" data-type="live">
        <view class="label">æ‰€åœ¨åŸå¸‚</view>
        <view class="picker-value {{livePlace ? '' : 'placeholder'}}">
          {{livePlace || 'è¯·é€‰æ‹©'}}
          <text class="arrow">â€º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å®ŒæˆæŒ‰é’® -->
  <button class="primary-btn" bindtap="handleComplete">å®Œæˆ</button>
</view>

<!-- æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨å¼¹çª— -->
<view class="picker-modal {{showDateTimePicker ? 'visible' : ''}}" catchtouchmove="preventBubble">
  <view class="picker-mask" bindtap="closeDateTimePicker"></view>
  <view class="picker-panel">
    <!-- å¤´éƒ¨ -->
    <view class="picker-header">
      <text class="picker-cancel" bindtap="closeDateTimePicker">å–æ¶ˆ</text>
      <text class="picker-hint">è‹¥ç”Ÿæ—¶ä¸è¯¦ï¼Œå¯é€‰æ‹©12:00ä½œä¸ºå‚è€ƒ</text>
      <text class="picker-confirm" bindtap="dateTimeNextStep">
        {{dateTimePickerTab === 'date' ? 'ä¸‹ä¸€æ­¥' : 'ç¡®è®¤'}}
      </text>
    </view>
    <!-- Tab åˆ‡æ¢ -->
    <view class="picker-tabs">
      <view
        class="picker-tab {{dateTimePickerTab === 'date' ? 'active' : ''}}"
        bindtap="switchDateTimeTab"
        data-tab="date"
      >
        é€‰æ‹©æ—¥æœŸ
        <view class="tab-indicator" wx:if="{{dateTimePickerTab === 'date'}}"></view>
      </view>
      <view
        class="picker-tab {{dateTimePickerTab === 'time' ? 'active' : ''}}"
        bindtap="switchDateTimeTab"
        data-tab="time"
      >
        é€‰æ‹©æ—¶é—´
        <view class="tab-indicator" wx:if="{{dateTimePickerTab === 'time'}}"></view>
      </view>
    </view>
    <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
    <view class="picker-content" wx:if="{{dateTimePickerTab === 'date'}}">
      <view class="picker-columns-labels columns-3">
        <text>å¹´</text>
        <text>æœˆ</text>
        <text>æ—¥</text>
      </view>
      <picker-view
        class="date-picker-view"
        value="{{datePickerValue}}"
        bindchange="onDatePickerChange"
        indicator-class="picker-indicator"
      >
        <picker-view-column>
          <view class="picker-item" wx:for="{{years}}" wx:key="*this">{{item}}</view>
        </picker-view-column>
        <picker-view-column>
          <view class="picker-item" wx:for="{{months}}" wx:key="*this">{{item}}</view>
        </picker-view-column>
        <picker-view-column>
          <view class="picker-item" wx:for="{{days}}" wx:key="*this">{{item}}</view>
        </picker-view-column>
      </picker-view>
    </view>
    <!-- æ—¶é—´é€‰æ‹©å™¨ -->
    <view class="picker-content" wx:if="{{dateTimePickerTab === 'time'}}">
      <view class="picker-columns-labels columns-2">
        <text>æ—¶</text>
        <text>åˆ†</text>
      </view>
      <picker-view
        class="time-picker-view"
        value="{{timePickerValue}}"
        bindchange="onTimePickerChange"
        indicator-class="picker-indicator"
      >
        <picker-view-column>
          <view class="picker-item" wx:for="{{hours}}" wx:key="*this">{{item}}</view>
        </picker-view-column>
        <picker-view-column>
          <view class="picker-item" wx:for="{{minutes}}" wx:key="*this">{{item}}</view>
        </picker-view-column>
      </picker-view>
    </view>
  </view>
</view>

<!-- åœ°åŒºé€‰æ‹©å™¨å¼¹çª— -->
<view class="picker-modal {{showRegionPicker ? 'visible' : ''}}" catchtouchmove="preventBubble">
  <view class="picker-mask" bindtap="closeRegionPicker"></view>
  <view class="region-panel">
    <!-- å¤´éƒ¨ -->
    <view class="region-header">
      <text class="region-title">è¯·é€‰æ‹©æ‰€åœ¨åœ°åŒº</text>
      <text class="region-close" bindtap="closeRegionPicker">âœ•</text>
    </view>
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <view class="region-breadcrumb">
      <text
        class="breadcrumb-item {{regionLevel === 0 ? 'active' : ''}}"
        bindtap="clickBreadcrumb"
        data-level="{{-1}}"
      >
        {{regionBreadcrumb.length === 0 ? 'è¯·é€‰æ‹©' : regionBreadcrumb[0].name}}
      </text>
      <text
        wx:if="{{regionBreadcrumb.length >= 1}}"
        class="breadcrumb-item {{regionLevel === 1 ? 'active' : ''}}"
        bindtap="clickBreadcrumb"
        data-level="{{0}}"
      >
        {{regionBreadcrumb.length >= 2 ? regionBreadcrumb[1].name : 'è¯·é€‰æ‹©'}}
      </text>
      <text
        wx:if="{{regionBreadcrumb.length >= 2}}"
        class="breadcrumb-item active"
      >
        è¯·é€‰æ‹©
      </text>
      <view class="breadcrumb-indicator" style="left: {{regionLevel * 120 + 60}}rpx;"></view>
    </view>
    <!-- åœ°åŒºåˆ—è¡¨ -->
    <scroll-view
      class="region-list"
      scroll-y
      wx:if="{{regionList.length}}"
      scroll-into-view="{{regionListScrollIntoView}}"
    >
      <view
        class="region-item {{regionSelectedCodes[regionLevel] === item.code ? 'active' : ''}}"
        wx:for="{{regionList}}"
        wx:key="code"
        bindtap="selectRegionItem"
        data-item="{{item}}"
        id="region-item-{{item.code}}"
      >
        {{item.name}}
      </view>
    </scroll-view>
    <view class="region-empty" wx:else>
      <text class="region-empty-text">æš‚æ— ä¸‹çº§åœ°åŒº</text>
      <button class="region-empty-btn" bindtap="confirmCurrentRegion">
        ç›´æ¥ä½¿ç”¨å½“å‰é€‰æ‹©
      </button>
    </view>
  </view>
</view>
