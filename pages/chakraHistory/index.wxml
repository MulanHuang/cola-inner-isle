<!--pages/chakraHistory/index.wxml-->
<view class="container chakra-history-container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-icon">ğŸ“Š</view>
    <view class="header-title">è„‰è½®æµ‹è¯•å†å²</view>
    <view class="header-subtitle">å›é¡¾ä½ çš„èƒ½é‡æˆé•¿ä¹‹æ—…</view>
  </view>

  <!-- ä»æœ¬åœ°å­˜å‚¨åŠ è½½ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-icon">â³</view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{historyList.length === 0}}" class="empty-container">
    <view class="empty-icon">ğŸŒ±</view>
    <view class="empty-title">è¿˜æ²¡æœ‰æµ‹è¯•è®°å½•</view>
    <view class="empty-desc">å®Œæˆä¸€æ¬¡è„‰è½®æµ‹è¯•ï¼Œå¼€å¯ä½ çš„èƒ½é‡æ¢ç´¢ä¹‹æ—…</view>
    <button class="btn-primary" bindtap="goToTest">
      å¼€å§‹æµ‹è¯•
    </button>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view wx:else class="history-list">
    <view 
      wx:for="{{historyList}}" 
      wx:key="id" 
      class="history-card card"
      bindtap="viewDetail"
      data-index="{{index}}"
    >
      <!-- å¡ç‰‡å¤´éƒ¨ -->
      <view class="card-header">
        <view class="test-date">
          <text class="date-icon">ğŸ“…</text>
          <text class="date-text">{{item.dateText}}</text>
        </view>
        <view class="test-time">{{item.timeText}}</view>
      </view>

      <!-- æ•´ä½“çŠ¶æ€ -->
      <view class="overall-status">
        <view class="status-icon">{{item.statusIcon}}</view>
        <view class="status-text">{{item.statusText}}</view>
      </view>

      <!-- è„‰è½®èƒ½é‡é¢„è§ˆ -->
      <view class="chakra-preview">
        <view wx:for="{{item.chakraPreview}}" wx:for-item="chakra" wx:key="type" class="preview-item">
          <view class="preview-emoji">{{chakra.emoji}}</view>
          <view class="preview-bar">
            <view 
              class="preview-bar-fill" 
              style="width: {{chakra.percentage}}%; background: {{chakra.color}}"
            ></view>
          </view>
          <view class="preview-percentage">{{chakra.percentage}}%</view>
        </view>
      </view>

      <!-- æŸ¥çœ‹è¯¦æƒ…æç¤º -->
      <view class="view-detail-hint">
        <text>ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†ç»“æœ</text>
        <text class="arrow-icon">â†’</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view wx:if="{{historyList.length > 0}}" class="bottom-actions">
    <button class="btn-secondary" bindtap="goToTest">
      ğŸ”„ é‡æ–°æµ‹è¯•
    </button>
    <button class="btn-primary" bindtap="backToHome">
      è¿”å›é¦–é¡µ
    </button>
  </view>
</view>

