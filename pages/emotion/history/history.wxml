<!--pages/emotion/history/history.wxml-->
<view class="container history-container">
  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="stat-item">
      <view class="stat-value">{{totalCount}}</view>
      <view class="stat-label">æ€»è®°å½•</view>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <view class="stat-value">{{recentDays}}</view>
      <view class="stat-label">è¿ç»­è®°å½•å¤©æ•°</view>
    </view>
  </view>

  <!-- æƒ…ç»ªåˆ—è¡¨ -->
  <view class="emotion-list">
    <view wx:for="{{emotions}}" wx:key="_id" class="emotion-record">
      <!-- å¤´éƒ¨ï¼šæƒ…ç»ª + æ—¶é—´ -->
      <view class="record-header">
        <view class="record-emotion">
          <text class="emotion-icon">{{item.emotionIcon}}</text>
          <text class="emotion-name">{{item.emotionName}}</text>
        </view>
        <view class="record-time">{{item.timeStr}}</view>
      </view>

      <!-- èƒ½é‡æŒ‡æ•° -->
      <view wx:if="{{item.energyLevel > 0}}" class="record-energy">
        <text class="energy-label">âš¡ èƒ½é‡æŒ‡æ•°</text>
        <view class="energy-stars">
          <text wx:for="{{[1,2,3,4,5]}}" wx:key="*this" class="star {{item.energyLevel >= item ? 'active' : ''}}">â˜…</text>
        </view>
      </view>

      <!-- æ„Ÿæ©å°äº‹ -->
      <view wx:if="{{item.gratitudeItems && item.gratitudeItems.length > 0}}" class="record-section gratitude-section">
        <view class="section-header">
          <text class="section-icon">ğŸ™</text>
          <text class="section-title">ä»Šæ—¥æ„Ÿæ©å°äº‹</text>
        </view>
        <view class="section-list">
          <view wx:for="{{item.gratitudeItems}}" wx:key="index" wx:for-item="gratitude" class="section-item">
            <text class="item-number">{{index + 1}}</text>
            <text class="item-text" user-select="{{true}}">{{gratitude}}</text>
          </view>
        </view>
      </view>

      <!-- å°æˆå°± -->
      <view wx:if="{{item.successItems && item.successItems.length > 0}}" class="record-section success-section">
        <view class="section-header">
          <text class="section-icon">ğŸŒŸ</text>
          <text class="section-title">ä»Šæ—¥å°æˆå°±</text>
        </view>
        <view class="section-list">
          <view wx:for="{{item.successItems}}" wx:key="index" wx:for-item="success" class="section-item">
            <text class="item-number">{{index + 1}}</text>
            <text class="item-text" user-select="{{true}}">{{success}}</text>
          </view>
        </view>
      </view>

      <!-- è‡ªç”±è¾“å…¥å†…å®¹ -->
      <view wx:if="{{item.description}}" class="record-description">
        <view class="description-header">
          <text class="description-icon">âœï¸</text>
          <text class="description-title">æƒ³è¯´çš„è¯</text>
        </view>
        <text class="description-content" user-select="{{true}}">{{item.description}}</text>
      </view>

      <!-- æ ‡ç­¾ -->
      <view wx:if="{{item.tagsDisplay && item.tagsDisplay.length > 0}}" class="record-tags">
        <view class="tags-header">
          <text class="tags-icon">ğŸ·ï¸</text>
          <text class="tags-title">æ ‡ç­¾</text>
        </view>
        <view class="tags-list">
          <view wx:for="{{item.tagsDisplay}}" wx:key="id" wx:for-item="tag" class="record-tag">
            <text class="tag-icon">{{tag.icon}}</text>
            <text class="tag-name">{{tag.name}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{emotions.length === 0}}" class="empty">
      <view class="empty-icon">ğŸ’­</view>
      <view class="empty-text">è¿˜æ²¡æœ‰æƒ…ç»ªè®°å½•</view>
      <view class="empty-hint">è®°å½•ä½ çš„æ„Ÿå—ï¼Œäº†è§£è‡ªå·±çš„æƒ…ç»ªå˜åŒ–</view>
    </view>
  </view>
</view>

