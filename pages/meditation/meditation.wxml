<!--pages/meditation/meditation.wxml-->

<!-- 第一层封面 Cover Layer -->
<view class="cover-layer {{showCover ? '' : 'cover-hidden'}}" wx:if="{{showCover}}">
  <view class="cover-content">
    <!-- 呼吸光圈 -->
    <view class="breath-circle-wrapper">
      <view class="breath-circle"></view>
      <view class="breath-circle-inner"></view>
    </view>

    <!-- 文案内容 -->
    <view class="cover-text">
      <view class="cover-title">🧘 正念练习</view>
      <view class="cover-subtitle">专注呼吸，放松身心</view>
    </view>

    <!-- 进入按钮 -->
    <view class="cover-btn-wrapper">
      <view class="cover-btn-glow"></view>
      <view class="cover-btn" bindtap="enterMeditation">
        <text class="btn-text">开始进入</text>
        <text class="btn-arrow">→</text>
      </view>
    </view>
  </view>
</view>

<!-- 自定义导航栏 -->
<view class="custom-navbar" style="padding-top: {{statusBarHeight}}px;">
  <view class="navbar-content">
    <!-- 左侧返回按钮 -->
    <view class="nav-left" bindtap="handleBack">
      <text class="back-icon">‹</text>
    </view>
    <!-- 中间标题 -->
    <view class="navbar-center">
      <image class="navbar-logo" src="/images/logo.svg" mode="aspectFit"></image>
      <view class="navbar-title">可乐心岛</view>
    </view>
    <!-- 右侧占位（保持对称） -->
    <view class="nav-right"></view>
  </view>
</view>

<view class="meditation-container page-with-custom-navbar" style="padding-top: {{navBarHeight}}px;">
  <!-- 固定头部区域 -->
  <view class="fixed-header">
    <view class="header">
      <view class="header-title">🧘 正念练习工具</view>
      <view class="header-subtitle">专注呼吸，放松身心</view>
    </view>

    <!-- 分类标签 -->
    <scroll-view class="category-tabs" scroll-x>
      <view
        wx:for="{{categories}}"
        wx:key="id"
        class="category-tab {{currentCategory === item.id ? 'active' : ''}}"
        bindtap="switchCategory"
        data-id="{{item.id}}">
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- 可滚动的音频列表区域 -->
  <scroll-view class="audio-scroll-view" scroll-y enhanced="{{true}}" show-scrollbar="{{false}}">
    <view class="audio-list">
      <view
        wx:for="{{audioList}}"
        wx:key="_id"
        class="audio-item"
        bindtap="playAudio"
        data-audio="{{item}}">
        <image class="audio-cover" src="{{item.cover}}" mode="aspectFill" lazy-load="{{true}}"></image>
        <view class="audio-info">
          <view class="audio-title">{{item.title}}</view>
          <text class="audio-desc" user-select="{{true}}">{{item.description}}</text>
          <view class="audio-meta">
            <text class="audio-duration">{{item.duration}}</text>
          </view>
        </view>
        <view class="audio-play-icon">开始</view>
      </view>

      <!-- 空状态 -->
      <view wx:if="{{audioList.length === 0}}" class="empty">
        <view class="empty-text">暂无引导内容</view>
      </view>

      <!-- 底部安全间距 -->
      <view class="audio-list-bottom-space"></view>
    </view>
  </scroll-view>
</view>

<!-- 全局悬浮音乐控制按钮 -->
<audio-float />
